<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>About Me – Hear It While You're Here</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="logo">About<span>Me</span></div>
    <nav>
      <a href="#vision">Vision</a>
      <a href="#how-it-works">How it works</a>
      <a href="#mental-health">Support</a>
      <a href="#auth" class="btn btn-outline">Log in / Sign up</a>
    </nav>
  </header>

  <main>
    <!-- Hero / Vision -->
    <section id="vision" class="hero">
      <div class="hero-text">
        <h1>Hear the best things people would say about you – while you're still here.</h1>
        <p class="quote">
          “Too often we only say the best things about someone at their funeral, and miss the opportunity
          to tell them how wonderful they really are when they are just a call away. This site is a chance
          for you to hear from others how they feel about someone before they’re gone.”
        </p>
        <button class="btn primary" onclick="scrollToAuth()">Create your page</button>
      </div>
      <div class="hero-card">
        <h2>Living Eulogy Preview</h2>
        <p class="username">@jane-doe</p>
        <div class="eulogy-card">
          <p><strong>From:</strong> Dad</p>
          <p>
            I’m proud of the woman you’ve become. Your kindness, grit, and ridiculous laugh have carried this
            family more times than you know.
          </p>
        </div>
        <div class="eulogy-card">
          <p><strong>From:</strong> Your best friend, Maya</p>
          <p>
            You were the first person who ever told me I mattered. I hope this page reminds you
            how much you matter to all of us.
          </p>
        </div>
      </div>
    </section>

    <!-- How it works / UI -->
    <section id="how-it-works" class="section">
      <h2>How About Me works</h2>
      <div class="steps">
        <div class="step">
          <h3>1. Create your profile</h3>
          <p>
            Add a photo, share as much or as little about yourself as you want, and choose your privacy settings.
          </p>
        </div>
        <div class="step">
          <h3>2. Invite friends & family</h3>
          <p>
            Send a private link so the people who know you best can write a “living eulogy” or tribute.
          </p>
        </div>
        <div class="step">
          <h3>3. Read, save, and share</h3>
          <p>
            You decide what’s public or private. Keep messages just for you, or share them so others can comment.
          </p>
        </div>
      </div>

      <div class="ui-notes">
        <h3>Privacy & control</h3>
        <ul>
          <li>Block or delete invitees at any time.</li>
          <li>Mark each tribute as private or public.</li>
          <li>Enable or disable comments on public posts.</li>
        </ul>
      </div>
    </section>

    <!-- Auth section: real signup + login wired to backend -->
    <section id="auth" class="section auth-section">
      <div class="auth-card">
        <h2>Create your account</h2>
        <p>Create an account to claim your About Me page.</p>
        <form id="signup-form" onsubmit="handleRegister(event)">
          <label>
            Name
            <input type="text" id="reg-name" required placeholder="Your name" />
          </label>
          <label>
            Email
            <input type="email" id="reg-email" required placeholder="you@example.com" />
          </label>
          <label>
            Password
            <input type="password" id="reg-password" required minlength="6" />
          </label>
          <button type="submit" class="btn primary">Create account</button>
        </form>
      </div>

      <div class="auth-card">
        <h2>Already have an account?</h2>
        <p>Log in to view or update your page.</p>
        <form id="login-form" onsubmit="handleLogin(event)">
          <label>
            Email
            <input type="email" id="login-email" required placeholder="you@example.com" />
          </label>
          <label>
            Password
            <input type="password" id="login-password" required />
          </label>
          <button type="submit" class="btn btn-outline">Log in</button>
        </form>
        <p id="auth-message" class="message"></p>
      </div>
    </section>

    <!-- Mental health resources -->
    <section id="mental-health" class="section support-section">
      <h2>If you’re struggling, you’re not alone.</h2>
      <p>
        Reading and writing these messages can bring up big feelings. If you need support right now, these
        resources are free and confidential:
      </p>
      <ul class="resource-list">
        <li><strong>988 Suicide &amp; Crisis Lifeline</strong> – Call or text <a href="tel:988">988</a>, or chat at <a href="https://988lifeline.org" target="_blank" rel="noreferrer">988lifeline.org</a></li>
        <li><strong>Veterans Crisis Line</strong> – Call <a href="tel:988">988</a> then press 1, or text <a href="sms:838255">838255</a></li>
        <li><strong>SAMHSA National Helpline</strong> – 1-800-662-HELP (4357)</li>
        <li><strong>NAMI HelpLine</strong> – 1-800-950-NAMI (6264) or <a href="mailto:helpline@nami.org">helpline@nami.org</a></li>
        <li><strong>The Trevor Project (LGBTQ+ youth)</strong> – 1-866-488-7386 or <a href="https://www.thetrevorproject.org/get-help/" target="_blank" rel="noreferrer">online chat & text</a></li>
      </ul>
      <p class="small-note">
        You’ll also see a simple “Need support?” link on every private profile page that brings you back to this list.
      </p>
    </section>
  </main>

  <footer class="site-footer">
    <p>About Me &copy; <span id="year"></span>. Built to help you hear the good things now, not later.</p>
  </footer>

  <!-- Auth + helper scripts -->
  <script>
    function scrollToAuth() {
      const el = document.getElementById('auth');
      if (el) {
        el.scrollIntoView({ behavior: 'smooth' });
      }
    }

    async function handleRegister(event) {
      event.preventDefault();
      const name = document.getElementById('reg-name').value;
      const email = document.getElementById('reg-email').value;
      const password = document.getElementById('reg-password').value;

      const messageBox = document.getElementById('auth-message');
      messageBox.style.color = 'inherit';
      messageBox.textContent = 'Creating your account...';

      try {
        const res = await fetch('/api/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, email, password })
        });

        const data = await res.json();

        if (data.ok) {
          messageBox.style.color = 'green';
          messageBox.textContent = 'Account created! You can now log in.';
          document.getElementById('signup-form').reset();
        } else {
          messageBox.style.color = 'red';
          messageBox.textContent = data.error || 'Something went wrong.';
        }
      } catch (err) {
        console.error(err);
        messageBox.style.color = 'red';
        messageBox.textContent = 'Network error. Please try again.';
      }
    }

    async function handleLogin(event) {
      event.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;

      const messageBox = document.getElementById('auth-message');
      messageBox.style.color = 'inherit';
      messageBox.textContent = 'Logging in...';

      try {
        const res = await fetch('/api/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });

        const data = await res.json();

        if (data.ok) {
          messageBox.style.color = 'green';
          messageBox.textContent = 'Welcome, ' + data.user.name + '!';
          // later: redirect to user dashboard/profile page
        } else {
          messageBox.style.color = 'red';
          messageBox.textContent = data.error || 'Login failed.';
        }
      } catch (err) {
        console.error(err);
        messageBox.style.color = 'red';
        messageBox.textContent = 'Network error. Please try again.';
      }
    }

    // Set footer year
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>

  <!-- Your existing app.js (if you still want to use it) -->
  <script src="app.js"></script>
</body>
</html>
